<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Dashboard คำนวณดอกเบี้ยผิดนัด</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.4.0/mermaid.min.js"></script>
<style>
body { font-family: 'Sarabun', sans-serif; margin:0; padding:20px; background:#f5f5f5; }
.container { max-width:800px; margin:auto; background:white; padding:20px; border-radius:15px; box-shadow:0 5px 20px rgba(0,0,0,0.1);}
h1,h2 { color: #002D62; }
.input-group { margin-bottom:15px; }
label { display:block; font-weight:bold; margin-bottom:5px; }
input[type="text"], input[type="number"], input[type="date"] { width:100%; padding:10px; border-radius:8px; border:1px solid #ccc; }
button { padding:12px 20px; background:#e91e63; color:white; border:none; border-radius:8px; cursor:pointer; font-weight:bold; }
.result-box { margin-top:15px; padding:15px; background:#ffebf2; border-radius:8px; text-align:center; font-weight:bold; color:#880e4f; }
/* Flowchart style */
.mermaid { text-align:center; margin-top:30px; }
</style>
</head>
<body>
<div class="container">
  <h1>คำนวณดอกเบี้ยผิดนัด</h1>
  <div class="input-group">
    <label>เงินต้น (Principal)</label>
    <input type="text" id="principal" placeholder="กรอกจำนวนเงินต้น">
  </div>
  <div class="input-group">
    <label>อัตราดอกเบี้ยผิดนัด (% ต่อปี)</label>
    <input type="number" id="rate" value="5">
  </div>
  <div class="input-group">
    <label>วันที่ครบกำหนดชำระ</label>
    <input type="date" id="dueDate">
  </div>
  <div class="input-group">
    <label>วันที่จ่ายจริง</label>
    <input type="date" id="paymentDate">
  </div>
  <button onclick="calculateInterest()">คำนวณดอกเบี้ยผิดนัด</button>
  <div id="result" class="result-box">ผลการคำนวณ: 0.00 บาท</div>

  <h2>Flowchart หลักการคำนวณ</h2>
  <div class="mermaid">
  flowchart TD
      A[เริ่มต้น] --> B{ตรวจสอบวันชำระ}
      B -->|จ่ายตรงเวลา| C[ดอกเบี้ยผิดนัด = 0]
      B -->|จ่ายช้า| D[คำนวณจำนวนวันผิดนัด]
      D --> E[ดอกเบี้ยผิดนัด = เงินต้น × อัตราดอกเบี้ย × วันผิดนัด / 365]
      E --> F[แสดงผลลัพธ์]
      C --> F
      F --> G[สิ้นสุด]
  </div>
</div>

<script>
mermaid.initialize({ startOnLoad:true });

function calculateInterest() {
  const principal = parseFloat(document.getElementById('principal').value.replace(/,/g,''));
  const rate = parseFloat(document.getElementById('rate').value);
  const dueDate = new Date(document.getElementById('dueDate').value);
  const paymentDate = new Date(document.getElementById('paymentDate').value);
  const resultBox = document.getElementById('result');

  if(isNaN(principal) || isNaN(rate) || isNaN(dueDate.getTime()) || isNaN(paymentDate.getTime())){
    resultBox.innerHTML = "⚠️ กรุณากรอกข้อมูลให้ครบและถูกต้อง";
    return;
  }

  // คำนวณวันผิดนัด
  const diffTime = paymentDate - dueDate;
  const daysOverdue = Math.max(0, Math.floor(diffTime / (1000*60*60*24)));

  // คำนวณดอกเบี้ยผิดนัด
  const interest = (principal * (rate/100) * daysOverdue)/365;

  resultBox.innerHTML = `ผลการคำนวณ: <strong>${interest.toFixed(2)}</strong> บาท<br>
  จำนวนวันผิดนัด: ${daysOverdue} วัน`;
}
</script>
</body>
</html>
