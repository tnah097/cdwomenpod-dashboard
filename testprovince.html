<!DOCTYPE html> 
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>CD Women POD Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css" />
  <link rel="stylesheet" href="https://cdn.datatables.net/fixedheader/3.4.0/css/fixedHeader.dataTables.min.css" />
  <style>
    body {
      font-family: 'Sarabun', sans-serif;
      margin: 0; 
      background: url('https://www.dga.or.th/wp-content/uploads/2025/06/20250612_074641550_iOS-1120x746.jpg') center/cover no-repeat;
      background-attachment: fixed;
      color: #000;
    }
    .dashboard-container { padding: 40px; background-color: rgba(255,255,255,0.9); width:100%; min-height:100vh; box-sizing:border-box; }
    .header { display:flex; justify-content:space-between; align-items:flex-start; flex-wrap:wrap; }
    .header-text h1{margin:0; font-size:2.5rem;} .header-text h2{margin:0; font-size:1.5rem;}
    .logo-container img{height:60px; margin-left:10px;}
    .cards { display:flex; gap:20px; margin-top:30px; flex-wrap:wrap; }
    .card { flex:1; min-width:200px; padding:20px; border-radius:12px; color:white; font-weight:bold; }
    .card .value { font-size:1.75rem; color:black; margin-top:10px; font-weight:normal; white-space:nowrap; }
    .card.pink { background-color:#e91e63; flex:0 0 auto; width:auto; }
    .card.light-pink { background-color:#f8bbd0; }
    .card.orange { background-color:#ff9800; }
    .card.deep-pastel-pink { background-color:#f06292; }
    table.dataTable { width:100% !important; border-collapse:collapse; font-size:0.85rem; color:black; }
    table.dataTable th, table.dataTable td { border:1px solid #ccc; padding:4px 6px; text-align:center; vertical-align:middle; white-space:nowrap; }
    table.dataTable thead th { background-color:#f06292; color:black; font-weight:bold; }
    table.dataTable.fixedHeader-floating { background-color:white; }
    .src-note{display:block; font-size:0.65rem; color:#555; margin-top:3px;}
    .filter-container{display:flex; flex-wrap:wrap; align-items:flex-end; gap:15px; padding:15px; background-color:#f8bbd0; border-radius:8px; margin-bottom:10px; margin-top:20px;}
    .filter-item{display:flex; flex-direction:column; min-width:160px; flex-grow:1;}
    .filter-item label{font-weight:bold; font-size:0.8rem; margin-bottom:4px; color:#333;}
    .filter-item select{width:100%; padding:6px; box-sizing:border-box; border:1px solid #aaa; border-radius:4px; font-family:'Sarabun',sans-serif; font-size:0.85rem; height:35px;}
    .reset-button-container{flex-grow:1; min-width:160px;}
    .reset-button-container button{width:100%; padding:6px 15px; font-family:'Sarabun',sans-serif; font-size:0.9rem; border:none; border-radius:4px; background-color:#d9534f; color:white; cursor:pointer; height:35px; font-weight:bold;}
    .reset-button-container button:hover{background-color:#c9302c;}
    .dataTables_wrapper .dataTables_length, .dataTables_wrapper .dataTables_filter { margin-bottom:15px; }
  </style>
</head>
<body>
<div class="dashboard-container">
  <div class="header">
    <div class="header-text">
      <h1><span style="color: navy;">CD</span><span style="color: deeppink;">Women</span><span style="color: red;">POD</span></h1>
      <h2><span style="color: black;">ฐานข้อมูล</span> <span style="color: red;" id="province-title">รายจังหวัด</span></h2>
      <div style="color: navy; font-weight: bold; margin-top: 8px;">
        <span style="font-size: 1.2rem;">ลูกหนี้กองทุนพัฒนาบทบาทสตรีระดับจังหวัด</span><br />
        <p align="right"><span style="font-size: 2rem;" id="update-date">ข้อมูล ณ วันที่ 27 สิงหาคม 2568 </span></p>
      </div>
    </div>
    <div class="logo-container">
      <img src="https://i.postimg.cc/507bjy9Z/cdd.png" alt="CDD Logo" width="80" height="140" />
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQZtkPBp_xmIFgEEmX2cyScE1QzabzZbtNdbQ&s" alt="Additional Logo" />
    </div>
  </div>

  <div class="cards">
    <div class="card pink">จำนวนโครงการ<div class="value" id="num-projects">-</div></div>
    <div class="card light-pink">ลูกหนี้คงเหลือ ณ 1 ต.ค. 2567 (A)<div class="value" id="debt-start">-</div>
      ลูกหนี้คงเหลือ ณ ปัจจุบัน (ก)<div class="value" id="debt-now">-</div>
    </div>
    <div class="card orange">หนี้ที่เกินกำหนดชำระ (B)<div class="value" id="overdue">-</div>
      ร้อยละหนี้เกินกำหนดชำระ<div class="value" id="percent-overdue">-</div>
    </div>
    <div class="card deep-pastel-pink">เงินที่อนุมัติ<div class="value" id="approved-money">-</div></div>
    <div class="card deep-pastel-pink">ลูกหนี้ที่ได้ดำเนินการตามกฎหมาย (ง)<div class="value" id="legal">-</div></div>
  </div>

  <h3>ตารางรายละเอียดข้อมูลโครงการรายอำเภอ</h3>
  <div id="filter-container" class="filter-container"></div>
  <table id="districtDetails" class="display" style="width:100%">
    <thead>
      <tr>
        <th>ลำดับ</th>
        <th>อำเภอ/เขต</th>
        <th>ตำบล</th>
        <th>ปีงบประมาณ</th>
        <th>เลขที่สัญญา</th>
        <th>ชื่อโครงการ</th>
        <th>ผู้เสนอโครงการ</th>
        <th>เงินอนุมัติ</th>
        <th>วันที่เริ่มต้นสัญญา</th>
        <th>วันที่สิ้นสุดสัญญา</th>
        <th>วันที่รับชำระล่าสุด</th>
        <th>งวดคงเหลือที่ต้องชำระ</th>
        <th>ลูกหนี้คงเหลือ ณ 1 ต.ค. 2567 (A) </th>
        <th>ลูกหนี้คงเหลือ ณ ปัจจุบัน (ก) </th>
        <th>หนี้ยังไม่ถึงกำหนดชำระ (ข) </th>
        <th>การไกล่เกลี่ยที่สามารถใช้บังคับคดีได้ (ค)</th>
        <th>พนักงานอัยการรับเรื่อง(ง1)</th>
        <th>ศาลประทับรับฟ้อง(ง2)</th>
        <th>ศาลได้มีคำพิพากษาให้ลูกหนี้ชำระหนี้(ง3)</th>
        <th>ศาลมีคำพิพากษาตามยอม(ง4)</th>
        <th>ป.วิ แพ่ง มาตรา 20 ตรี(ง5)</th>
        <th>ดำเนินคดีอาญา(ง6)</th>
        <th>ลูกหนี้ที่ได้ดำเนินการตามกฎหมาย (ง)</th>
        <th>จำนวนหนี้ที่เกินกำหนดชำระ (B)</th>
        <th>ร้อยละหนี้เกินกำหนดชำระ</th>
        <th>สถานะการชำระหนี้</th>
        <th>สถานะโครงการ</th>
        <th>หมายเหตุ</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/fixedheader/3.4.0/js/dataTables.fixedHeader.min.js"></script>
<script>
  // ... (JS ทั้งหมดเหมือนต้นฉบับของคุณ พร้อมการดึงข้อมูลตรงกับ Apps Script)
</script>
</body>
</html>
